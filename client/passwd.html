<head>
  <title>passwd</title>
</head>

<body>
  <div class="container">
    <div class="row">
      <div class="span3">
        {{loginButtons align="left"}}
      </div>
    </div>
    {{#if currentUser}}
      {{> usercontent}}
    {{/if}}
  </div>
</body>

<template name="usercontent">
  <div class="row">
    <div class="span3">
      <input type="text" id="search" class="search-query" placeholder="search" autocomplete="off" />
    </div>
    <div class="span3">
      <a class="btn btn-primary" href="/{{userId}}/passwds.csv">CSV</a>
    </div>
    <div class="span3 input-append control-group {{wrongPassphraseClass}}">
      <div class="controls">
        <input type="password" id="passphrase"
               placeholder="passphrase"/>
        <button id="button-passphrase" class="btn"
                 type="button">
          <i class="icon-edit"></i>
      </div>
      </button>
    </div>

    <div id="modal-passphrase" class="modal hide fade">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h3>Set Encryption Passphrase</h3>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="span3">
            <input type="password" id="passphrase-new"
                   placeholder="new passphrase"/>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button id="button-passphrase-change" class="btn btn-primary"
                data-dismiss="modal">Change</button>
      </div>
    </div>
  </div>
  <div class="row">
    {{> new}}
  </div>
  <div class="row">
    <div class="span12">
      <table class="table table-striped">
        <thead>
          <tr>
            <th>Title</th>
            <th>Username</th>
            <th>Password</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
        {{> passwdlist}}
        </tbody>
      </table>
    </div>
  </div>
</template>

<template name="new">
  <div class="span3">
    <input type="text" id="new-title" placeholder="title" />
  </div>
  <div class="span3">
    <input type="text" id="new-username" placeholder="username" />
  </div>
  <div class="span3">
    <input type="password" id="new-password" placeholder="password" />
  </div>
  <div class="span1">
    {{#if newEnabled}}
    <button class="btn btn-primary" id="button-new">Add</button>
    {{else}}
    <button class="btn btn-primary" id="button-new" disabled="true">Add</button>
    {{/if}}
  </div>
</template>

<template name="passwdlist">
{{#each entries}}
  <tr>
    {{> passwdcell passwdcelltitle }}
    {{> passwdcell passwdcellusername }}
    {{> passwdcell passwdcelldecrypt }}
    <td><a class="trash" href="#"><i class="icon-trash"> </i></a></td>
  </tr>
{{/each}}
</template>

<template name="passwdcell">
    <td class="cell">
    {{#if editing}}
      <div class="edit">
        <input class="cell-input" id="cell-input" type="text" value="{{value}}" />
      </div>
    {{else}}
      <div class="display">
        {{#if txtvalue}}
          {{txtvalue}}
        {{/if}}
      </div>
    {{/if}}
    </td>
</template>
